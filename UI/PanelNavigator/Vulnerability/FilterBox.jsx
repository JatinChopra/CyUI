import React, { useEffect } from "react";

import { styled } from "@mui/material/styles";
import InputLabel from "@mui/material/InputLabel";
import MenuItem from "@mui/material/MenuItem";
import FormControl from "@mui/material/FormControl";
import Select from "@mui/material/Select";
import InputBase from "@mui/material/InputBase";
import ListItemText from "@mui/material/ListItemText";

import Checkbox from "@mui/material/Checkbox";

import { useDispatch } from "react-redux";
import { updateFilter } from "./slices/filterSlice";

import { GoDotFill } from "react-icons/go";

const filterColors = {
  New: "#058AA6",
  Triage: "#E32273",
  Duplicate: "#EFD237",
  Informative: "#9F9B9B",
  Resolve: "#B2C615",
  Retest: "#46F655",
  "not Applicable": "#FF0700",
  "Won't Fix": "#FF0700",
};

const BootstrapInput = styled(InputBase)(({ theme }) => ({
  "label + &": {
    color: "white",
  },
  "& .MuiInputBase-input": {
    borderRadius: 4,
    color: "white",
    position: "relative",
    width: "200px",
    backgroundColor: "#282D31",
    border: "2px solid white",
    fontSize: 16,
    padding: "10px 26px 10px 12px",
    "&:focus": {
      borderRadius: 4,
      borderColor: "white",
    },
  },
}));

const ITEM_HEIGHT = 48;
const ITEM_PADDING_TOP = 8;
const MenuProps = {
  PaperProps: {
    style: {
      maxHeight: ITEM_HEIGHT * 8 + ITEM_PADDING_TOP,
      background: "#404246",
      color: "white",
    },
  },
};

const filterNames = [
  "New",
  "Triage",
  "Duplicate",
  "Informative",
  "Resolve",
  "Retest",
  "Not Applicable",
  "Won't Fix",
];

const FilterBox = () => {
  const [setFilters, setSetFilters] = React.useState([]);
  const dispatch = useDispatch();

  const handleChange = (event) => {
    console.log("handling change");
    const {
      target: { value },
    } = event;
    setSetFilters(typeof value === "string" ? value.split(",") : value);
  };

  React.useEffect(() => {
    console.log("filterbox: ", setFilters);
    dispatch(updateFilter(setFilters));
  }, [setFilters]);

  return (
    <FormControl
      variant="standard"
      sx={{
        color: "white",
        "& .MuiSelect-icon": {
          color: "white",
          marginRight: "10px",
        },
      }}
    >
      <Select
        value={setFilters}
        multiple
        onChange={handleChange}
        renderValue={(selected) => selected.join(", ")}
        input={<BootstrapInput />}
        MenuProps={MenuProps}
        sx={{ color: "white" }}
      >
        {filterNames.map((name, index) => (
          <MenuItem
            key={name}
            selected={true}
            value={name}
            sx={{
              borderBottom: "1px solid gray",
              "&.Mui-selected": {
                background: "none", // Remove the background color on selected items
              },
              "&.Mui-hover": {
                background: "none", // Remove the background color on selected items
              },
            }}
          >
            <GoDotFill
              color={filterColors[name]}
              style={{
                marginRight: "1px",
                fontSize: "32px",
                marginBottom: "2px",
              }}
            />
            <ListItemText primary={name} />
            <Checkbox
              checked={setFilters.indexOf(name) > -1}
              sx={{ color: "white" }}
            />
          </MenuItem>
        ))}
      </Select>
    </FormControl>
  );
};

export default FilterBox;
